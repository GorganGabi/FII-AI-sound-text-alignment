<!DOCTYPE html>
<html lang="en">
<head>
	<title>Text Alignment</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" type="text/css" href="proiectIA.css">
	<script type="text/javascript" src="vers.json"></script>
</head>
<body>
	<div class="header">
		<h2>Text Alignment</h2>
	</div>

  <div class="main">
    <h1>Fun way to align your text</h1>
    <p>Insert your text&audio file down below</p>
    <form action="api/upload" method="POST" enctype="multipart/form-data">
      <textarea rows="2" cols="50" class="mainTexarea"  name="text" placeholder="Textul tau aici"></textarea>
       <label for="browse"></label>
          <br>
             <input type="file" name="mySound" >
      <input type='submit' name='trimite' value='Send'>
    </form>
  </div>
  <br>
  <br>
  <br>
  <div class="demo">
  <script src="https://unpkg.com/wavesurfer.js"></script>
<div id="waveform" ></div>
<script type="text/javascript">
  var wavesurfer = WaveSurfer.create({
    container: '#waveform',
    scrollParent: true,
    waveColor: 'green',
    progressColor: 'white'
});
  wavesurfer.on('ready', function () {
    wavesurfer.play();
});

  wavesurfer.load('10bears.mp3');
</script>

<div class="controls">
<button class="btn btn-primary" onclick="wavesurfer.playPause()">
      <i class="fa fa-play"></i>
      Play
      /
      <i class="fa fa-pause"></i>
      Pause
    </button>
</div>
</div>	
<div id="textFormDiv">
</div>
   <audio id="audiofile" src="10bears.mp3" controls autostart></audio><br>
        <div id="subtitles"></div>
        <script>
  ( function(win, doc) {
      var audioPlayer = doc.getElementById("audiofile");
      var subtitles = doc.getElementById("subtitles");
	  var syncData = data;

      createSubtitle();

      function createSubtitle()
      {
          var element;
          for (var i = 0; i < syncData.length; i++) {
              element = doc.createElement('span');
              element.setAttribute("id", "c_" + i);
              element.innerText = syncData[i].text + " ";
              subtitles.appendChild(element);
          }
      }

      audioPlayer.addEventListener("timeupdate", function(e){
          syncData.forEach(function(element, index, array){
              if( audioPlayer.currentTime >= element.start && audioPlayer.currentTime <= element.end )
                  if(element.matched=="0")
				  {	
					subtitles.children[index].style.background = 'yellow';
					subtitles.children[index-1].style.background = 'gray';
				  }
				  else if (element.matched=="1") 
				  {
					subtitles.children[index].style.background = 'red';
					subtitles.children[index-1].style.background = 'gray';
				  }
				  
          }
		  ); 
		  
      });
  }(window, document));
        </script>
	<div class="footer">
  		<p> 2018 &copy; All rights reserved | developed by UAIC Students</p>
	</div>

</body>
</html>
